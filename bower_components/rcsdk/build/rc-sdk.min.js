!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("es6-promise"),require("crypto-js"),require("pubnub")):"function"==typeof define&&define.amd?define(["es6-promise","crypto-js","pubnub"],e):"object"==typeof exports?exports.RCSDK=e(require("es6-promise"),require("crypto-js"),require("pubnub")):t.RCSDK=e(t.Promise,t.CryptoJS,t.PUBNUB)}(this,function(t,e,n){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){var r;r=function(t,e,r){"use strict";var o=n(2);r.exports=n(5)({CryptoJS:n(3),localStorage:window.localStorage,Promise:o&&"Promise"in o?o.Promise:window.Promise,PUBNUB:n(4),XHR:window.XMLHttpRequest})}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(e){e.exports=t},function(t){t.exports=e},function(t){t.exports=n},function(t,e,n){var r;r=function(t,e,r){"use strict";r.exports=function(t){function e(e){e=e||{},this._context=n(6).$get(t),this.getCache().setPrefix(e.cachePrefix||""),this.getPlatform().setServer(e.server).setCredentials(e.appKey,e.appSecret)}if(e.version="1.2.1",e.prototype.getContext=function(){return this._context},e.prototype.getRequest=function(){return n(7).$get(this.getContext())},e.prototype.getResponse=function(t,e,r,o){return n(8).$get(this.getContext(),t,e,r,o)},e.prototype.getAjaxObserver=function(){return n(9).$get(this.getContext())},e.prototype.getXhrResponse=function(){return n(10).$get(this.getContext())},e.prototype.getPlatform=function(){return n(11).$get(this.getContext())},e.prototype.getCache=function(){return n(12).$get(this.getContext())},e.prototype.getSubscription=function(){return n(13).$get(this.getContext())},e.prototype.getPageVisibility=function(){return n(14).$get(this.getContext())},e.prototype.getHelper=function(){return n(15).$get(this.getContext())},e.prototype.getObservable=function(){return n(16).$get(this.getContext())},e.prototype.getValidator=function(){return n(17).$get(this.getContext())},e.prototype.getLog=function(){return n(18).$get(this.getContext())},e.prototype.getUtils=function(){return n(19).$get(this.getContext())},e.prototype.getList=function(){return n(20).$get(this.getContext())},e.prototype.getCountryHelper=function(){return n(21).$get(this.getContext())},e.prototype.getDeviceModelHelper=function(){return n(22).$get(this.getContext())},e.prototype.getLanguageHelper=function(){return n(23).$get(this.getContext())},e.prototype.getLocationHelper=function(){return n(24).$get(this.getContext())},e.prototype.getShippingMethodHelper=function(){return n(25).$get(this.getContext())},e.prototype.getStateHelper=function(){return n(26).$get(this.getContext())},e.prototype.getTimezoneHelper=function(){return n(27).$get(this.getContext())},e.prototype.getAccountHelper=function(){return n(28).$get(this.getContext())},e.prototype.getBlockedNumberHelper=function(){return n(29).$get(this.getContext())},e.prototype.getCallHelper=function(){return n(30).$get(this.getContext())},e.prototype.getConferencingHelper=function(){return n(31).$get(this.getContext())},e.prototype.getContactHelper=function(){return n(32).$get(this.getContext())},e.prototype.getContactGroupHelper=function(){return n(33).$get(this.getContext())},e.prototype.getDeviceHelper=function(){return n(34).$get(this.getContext())},e.prototype.getExtensionHelper=function(){return n(35).$get(this.getContext())},e.prototype.getForwardingNumberHelper=function(){return n(36).$get(this.getContext())},e.prototype.getMessageHelper=function(){return n(37).$get(this.getContext())},e.prototype.getPhoneNumberHelper=function(){return n(38).$get(this.getContext())},e.prototype.getPresenceHelper=function(){return n(39).$get(this.getContext())},e.prototype.getRingoutHelper=function(){return n(40).$get(this.getContext())},e.prototype.getServiceHelper=function(){return n(41).$get(this.getContext())},!(t&&"CryptoJS"in t&&"localStorage"in t&&"Promise"in t&&"PUBNUB"in t&&"XHR"in t))throw new Error("Injections object is not complete");return t.XHR=t.XHR||function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(n){}throw new Error("This browser does not support XMLHttpRequest.")},e}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){this.singletons={},this.injections=t,this.stubPubnub=!1,this.stubAjax=!1}o.prototype.createSingleton=function(t,e){return this.singletons[t]||(this.singletons[t]=e()),this.singletons[t]},o.prototype.usePubnubStub=function(t){return this.stubPubnub=!!t,this},o.prototype.useAjaxStub=function(t){return this.stubAjax=!!t,this},o.prototype.getCryptoJS=function(){return this.injections.CryptoJS},o.prototype.getPubnub=function(){return this.stubPubnub?n(42).$get(this):this.injections.PUBNUB},o.prototype.getLocalStorage=function(){return this.createSingleton("localStorage",function(){return"function"==typeof this.injections.localStorage?new this.injections.localStorage:this.injections.localStorage}.bind(this))},o.prototype.getPromise=function(){return this.injections.Promise},o.prototype.getXHR=function(){return this.stubAjax?n(43).$get(this):new this.injections.XHR},r.exports={Class:o,$get:function(t){return new o(t)}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this),this.async=!0,this.method="",this.url="",this.query=null,this.body={},this.context=t,this.xhr=null,this.observer=n(9).$get(t)}{var i=n(44).Class,s=n(8),u=n(19);n(18)}o.prototype=Object.create(i.prototype),Object.defineProperty(o.prototype,"constructor",{value:o,enumerable:!1}),o.prototype.isLoaded=function(){return!!this.xhr},o.prototype.setOptions=function(t){return t=t||{},"body"in t||!t.post||(t.body=t.post),"query"in t||!t.get||(t.query=t.get),"method"in t&&(this.method=t.method),"url"in t&&(this.url=t.url),"query"in t&&(this.query=t.query),"body"in t&&(this.body=t.body),"headers"in t&&this.setHeaders(t.headers),"async"in t&&(this.async=!!t.async),this},o.prototype.checkOptions=function(){if(!this.url)throw new Error("Url is not defined");if(this.hasHeader("Accept")||this.setHeader("Accept",i.jsonContentType),this.hasHeader("Content-Type")||this.setHeader("Content-Type",i.jsonContentType),this.method=this.method?this.method.toUpperCase():"GET",["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"].indexOf(this.method)<0)throw new Error("Method has wrong value");return this},o.prototype.getEncodedBody=function(){return"GET"===this.method?null:"string"==typeof this.body?this.body:this.isJson()?JSON.stringify(this.body):this.isUrlEncoded()?u.queryStringify(this.body):this.body},o.prototype.send=function(){this.observer.emit(this.observer.events.beforeRequest,this);var t=new(this.context.getPromise())(function(t,e){this.checkOptions();var n=this.getXHR(),r=this.url+(this.query?(this.url.indexOf("?")>-1?"&":"?")+u.queryStringify(this.query):"");n.open(this.method,r,this.async),n.withCredentials=!0,n.onload=function(){var r=s.$get(this.context,n.status,n.statusText,n.responseText,n.getAllResponseHeaders());if(r.error){var o=r.error;o.ajax=r,o.response=r,o.request=this,e(o)}else t(r)}.bind(this),n.onerror=function(){var t=new Error("The request cannot be sent");t.request=this,t.response=null,t.ajax=null,e(t)}.bind(this),u.forEach(this.headers,function(t,e){t&&n.setRequestHeader(e,t)}),n.send(this.getEncodedBody()),this.xhr=n}.bind(this));return t.then(function(t){return this.observer.emit(this.observer.events.requestSuccess,t,this),t}.bind(this))["catch"](function(t){throw this.observer.emit(this.observer.events.requestError,t),t}.bind(this))},o.prototype.getXHR=function(){return this.context.getXHR()},o.prototype.destroy=function(){this.xhr&&this.xhr.abort()},r.exports={Class:o,$get:function(t){return new o(t)}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t,e,n,r,p){if(i.call(this),"string"==typeof r&&(r=r.replace(/\r/g,""),!p)){var l=r.split(c);p=l.length>1?l.shift():{},r=l.join(c)}this.data=null,this.json=null,this.responses=[],this.error=null,1223==e&&(e=204),this.status=e,this.statusText=n,this.body=r,this.context=t;try{if("string"==typeof p?(p||"").split("\n").forEach(function(t){if(t){var e=t.split(a),n=e.shift().trim();this.setHeader(n,e.join(a).trim())}},this):this.setHeaders(p),this.hasHeader(i.contentType)||this.setHeader(i.contentType,i.jsonContentType),this.isJson()&&this.body&&"string"==typeof this.body)this.json=JSON.parse(this.body),this.data=this.json,this.checkStatus()||(this.error=new Error(this.getError()));else if(this.isMultipart()){var h=this.getContentType().match(/boundary=([^;]+)/i)[1],d=this.body.split(u+h);""===d[0].trim()&&d.shift(),d[d.length-1].trim()==u&&d.pop();var f=new o(this.context,this.status,"",d.shift());this.responses=d.map(function(t,e){var n=f.data.response[e].status;return new o(this.context,n,"",t)},this),this.data=this.responses}else this.data=this.body}catch(y){s.error("Response.parseResponse(): Unable to parse data"),s.error(y.stack||y),s.error(this.body),this.error=y}}var i=n(44).Class,s=(n(19),n(18)),u="--",a=":",c="\n\n";o.prototype=Object.create(i.prototype),Object.defineProperty(o.prototype,"constructor",{value:o,enumerable:!1}),o.prototype.isUnauthorized=function(){return 401==this.status},o.prototype.checkStatus=function(){return this.status>=200&&this.status<300},o.prototype.getError=function(){return this.data.message||this.data.error_description||this.data.description||"Unknown error"},r.exports={Class:o,$get:function(t,e,n,r,i){return new o(t,e,n,r,i)}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(){i.call(this)}var i=n(16).Class;o.prototype=Object.create(i.prototype),o.prototype.events={beforeRequest:"beforeRequest",requestSuccess:"requestSuccess",requestError:"requestError"},r.exports={Class:o,$get:function(t){return t.createSingleton("AjaxObserver",function(){return new o})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,n){"use strict";function r(){this.responses=[]}r.prototype.add=function(t){this.responses.push(t)},r.prototype.clear=function(){this.responses=[]},r.prototype.find=function(t){var e=null;return this.responses.forEach(function(n){t.url.indexOf(n.path)>-1&&(!n.test||n.test(t))&&(e=n)}),e},n.exports={Class:r,$get:function(t){return t.createSingleton("XhrResponse",function(){return new r(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){s.call(this),this.server="",this.apiKey="",this.account="~",this.urlPrefix="/restapi",this.apiVersion="v1.0",this.accountPrefix="/account/",this.accessTokenTtl=null,this.refreshTokenTtl=36e3,this.refreshTokenTtlRemember=604800,this.refreshHandicapMs=6e4,this.refreshDelayMs=100,this.clearCacheOnRefreshError=!0,this.refreshPromise=null,this.context=t}var i=n(19),s=n(16).Class,u=n(18),a="forced";o.prototype=Object.create(s.prototype),Object.defineProperty(o.prototype,"constructor",{value:o,enumerable:!1}),o.prototype.cacheId="platform",o.prototype.pollInterval=250,o.prototype.releaseTimeout=5e3,o.prototype.events={accessViolation:"accessViolation",logoutSuccess:"logoutSuccess",logoutError:"logoutError",authorizeSuccess:"authorizeSuccess",authorizeError:"authorizeError",refreshSuccess:"refreshSuccess",refreshError:"refreshError"},o.prototype.getStorage=function(){return n(12).$get(this.context)},o.prototype.getRequest=function(){return n(7).$get(this.context)},o.prototype.clearStorage=function(){return this.getStorage().clean(),this},o.prototype.setCredentials=function(t,e){var n=(t||"")+":"+(e||"");return":"==n?this:(this.apiKey="function"==typeof btoa?btoa(n):new Buffer(n).toString("base64"),this)},o.prototype.setServer=function(t){return this.server=t||"",this},o.prototype.remember=function(t){var e=this.cacheId+"-remember";return void 0!==t?(this.getStorage().setItem(e,t),this):this.getStorage().getItem(e)||!1},o.prototype.authorize=function(t){return t=t||{},t.remember=t.remember||!1,this.authCall({url:"/restapi/oauth/token",post:{grant_type:"password",username:t.username,extension:t.extension||"",password:t.password,access_token_ttl:this.accessTokenTtl,refresh_token_ttl:t.remember?this.refreshTokenTtlRemember:this.refreshTokenTtl}}).then(function(e){return this.setCache(e.data).remember(t.remember).emitAndCallback(this.events.authorizeSuccess,[]),e}.bind(this))["catch"](function(t){throw this.clearStorage().emitAndCallback(this.events.authorizeError,[t]),t}.bind(this))},o.prototype.isPaused=function(){var t=this.getStorage(),e=this.cacheId+"-refresh";return!!t.getItem(e)&&Date.now()-parseInt(t.getItem(e))<this.releaseTimeout},o.prototype.pause=function(){return this.getStorage().setItem(this.cacheId+"-refresh",Date.now()),this},o.prototype.resume=function(){return this.getStorage().removeItem(this.cacheId+"-refresh"),this},o.prototype.refresh=function(){var t=new(this.context.getPromise())(function(t,e){return this.isPaused()?t(this.refreshPolling(null)):(this.pause(),void setTimeout(function(){var n=this.getAuthData();return u.debug("Platform.refresh(): Performing token refresh (access token",n.access_token,", refresh token",n.refresh_token,")"),n&&n.refresh_token?Date.now()>n.refreshExpireTime?e(new Error("Refresh token has expired")):this.isPaused()?void t(this.authCall({url:"/restapi/oauth/token",post:{grant_type:"refresh_token",refresh_token:n.refresh_token,access_token_ttl:this.accessTokenTtl,refresh_token_ttl:this.remember()?this.refreshTokenTtlRemember:this.refreshTokenTtl}})):e(new Error("Queue was resumed before refresh call")):e(new Error("Refresh token is missing"))}.bind(this),this.refreshDelayMs))}.bind(this));return t.then(function(t){if(!t||!t.data)return t;if(u.info("Platform.refresh(): Token was refreshed"),!t.data.refresh_token||!t.data.access_token){var e=new Error("Malformed OAuth response");throw e.ajax=t,e}return this.setCache(t.data).resume(),t}.bind(this)).then(function(t){return this.emit(this.events.refreshSuccess,t),t}.bind(this))["catch"](function(t){throw this.clearCacheOnRefreshError&&this.clearStorage(),this.emitAndCallback(this.events.accessViolation,[t]).emitAndCallback(this.events.refreshError,[t]),t}.bind(this))},o.prototype.logout=function(){return this.pause(),this.authCall({url:"/restapi/oauth/revoke",post:{token:this.getToken()}}).then(function(t){return this.resume().clearStorage().emit(this.events.logoutSuccess,t),t}.bind(this))["catch"](function(t){throw this.resume().emitAndCallback(this.events.accessViolation,[t]).emitAndCallback(this.events.logoutError,[t]),t}.bind(this))},o.prototype.refreshPolling=function(t){return this.refreshPromise?this.refreshPromise:(this.refreshPromise=new(this.context.getPromise())(function(e,n){u.warn("Platform.refresh(): Refresh is already in progress polling started"),i.poll(function(r){return this.isPaused()?r():(this.refreshPromise=null,this.resume(),void(this.isTokenValid()?e(t):n(new Error("Automatic authentification timeout"))))}.bind(this),this.pollInterval)}.bind(this)),this.refreshPromise)},o.prototype.getToken=function(){return this.getAuthData().access_token},o.prototype.getTokenType=function(){return this.getAuthData().token_type},o.prototype.getAuthData=function(){return this.getStorage().getItem(this.cacheId)||{token_type:"",access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}},o.prototype.isTokenValid=function(){var t=this.getAuthData();return t.token_type==a||new Date(t.expireTime).getTime()-this.refreshHandicapMs>Date.now()&&!this.isPaused()},o.prototype.isAuthorized=function(){return this.isTokenValid()?this.context.getPromise().resolve(!0):this.refresh()},o.prototype.cancelAccessToken=function(){return this.setCache(i.extend(this.getAuthData(),{access_token:"",expires_in:0}))},o.prototype.setCache=function(t){var e=this.getAuthData();return u.info("Platform.setCache(): Tokens were updated, new:",t,", old:",e),t.expireTime=Date.now()+1e3*t.expires_in,t.refreshExpireTime=Date.now()+1e3*t.refresh_token_expires_in,this.getStorage().setItem(this.cacheId,t),this},o.prototype.forceAuthentication=function(){return this.setCache({token_type:a,access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}),this},o.prototype.apiCall=function(t){return t=t||{},t.url=this.apiUrl(t.url,{addServer:!0}),this.isAuthorized().then(function(){var e=this.getToken();return this.getRequest().setOptions(t).setHeader("Authorization",this.getTokenType()+(e?" "+e:"")).send()}.bind(this))["catch"](function(e){if(!e.ajax||!e.ajax.isUnauthorized())throw e;return this.cancelAccessToken(),this.refresh().then(function(){return this.apiCall(t)}.bind(this))}.bind(this))},o.prototype.get=function(t,e){return e=e||{},e.url=t,e.method="GET",this.apiCall(e)},o.prototype.post=function(t,e){return e=e||{},e.url=t,e.method="POST",this.apiCall(e)},o.prototype.put=function(t,e){return e=e||{},e.url=t,e.method="PUT",this.apiCall(e)},o.prototype["delete"]=function(t,e){return e=e||{},e.url=t,e.method="DELETE",this.apiCall(e)},o.prototype.authCall=function(t){return t=t||{},t.method=t.method||"POST",t.url=this.apiUrl(t.url,{addServer:!0}),this.getRequest().setOptions(t).setHeader("Content-Type","application/x-www-form-urlencoded").setHeader("Accept","application/json").setHeader("Authorization","Basic "+this.apiKey).send()},o.prototype.apiUrl=function(t,e){t=t||"",e=e||{};var n="";return e.addServer&&-1==t.indexOf("http://")&&-1==t.indexOf("https://")&&(n+=this.server),-1==t.indexOf(this.urlPrefix)&&(n+=this.urlPrefix+"/"+this.apiVersion),t.indexOf(this.accountPrefix)>-1&&n.replace(this.accountPrefix+"~",this.accountPrefix+this.account),n+=t,(e.addMethod||e.addToken)&&(n+=t.indexOf("?")>-1?"&":"?"),e.addMethod&&(n+="_method="+e.addMethod),e.addToken&&(n+=(e.addMethod?"&":"")+"access_token="+this.getToken()),n},r.exports={Class:o,$get:function(t){return t.createSingleton("Platform",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this),this.setPrefix(),this.storage=t.getLocalStorage()}{var i=n(16).Class;n(19)}o.prototype=Object.create(i.prototype),Object.defineProperty(o.prototype,"constructor",{value:o,enumerable:!1}),o.prototype.setPrefix=function(t){return this.prefix=t||"rc-",this},o.prototype.prefixKey=function(t){return this.prefix+t},o.prototype.setItem=function(t,e){return this.storage.setItem(this.prefixKey(t),JSON.stringify(e)),this},o.prototype.removeItem=function(t){return this.storage.removeItem(this.prefixKey(t)),this},o.prototype.getItem=function(t){var e=this.storage.getItem(this.prefixKey(t));return e?JSON.parse(e):null},o.prototype.clean=function(){for(var t in this.storage)this.storage.hasOwnProperty(t)&&0===t.indexOf(this.prefix)&&(this.storage.removeItem(t),delete this.storage[t]);return this},r.exports={Class:o,$get:function(t){return t.createSingleton("Cache",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this),this.eventFilters=[],this.timeout=null,this.subscription={eventFilters:[],expirationTime:"",expiresIn:0,deliveryMode:{transportType:"PubNub",encryption:!1,address:"",subscriberKey:"",secretKey:""},id:"",creationTime:"",status:"",uri:""},this.pubnub=null,this.context=t}var i=n(16).Class,s=n(18),u=n(19),a=6e4;o.prototype=Object.create(i.prototype),Object.defineProperty(o.prototype,"constructor",{value:o,enumerable:!1}),o.prototype.events={notification:"notification",removeSuccess:"removeSuccess",removeError:"removeError",renewSuccess:"renewSuccess",renewError:"renewError",subscribeSuccess:"subscribeSuccess",subscribeError:"subscribeError"},o.prototype.getPubnub=function(){return this.context.getPubnub()},o.prototype.getCrypto=function(){return this.context.getCryptoJS()},o.prototype.getPlatform=function(){return n(11).$get(this.context)},o.prototype.register=function(t){return this.isSubscribed()?this.renew(t):this.subscribe(t)},o.prototype.addEvents=function(t){return this.eventFilters=this.eventFilters.concat(t),this},o.prototype.setEvents=function(t){return this.eventFilters=t,this},o.prototype.getFullEventFilters=function(){return this.eventFilters.map(function(t){return this.getPlatform().apiUrl(t)}.bind(this))},o.prototype.subscribe=function(t){return t=t||{},t.events&&(this.eventFilters=t.events),this.clearTimeout(),new(this.context.getPromise())(function(t){if(!this.eventFilters||!this.eventFilters.length)throw new Error("Events are undefined");t(this.getPlatform().apiCall({method:"POST",url:"/restapi/v1.0/subscription",post:{eventFilters:this.getFullEventFilters(),deliveryMode:{transportType:"PubNub"}}}))}.bind(this)).then(function(t){return this.updateSubscription(t.data).subscribeAtPubnub().emit(this.events.subscribeSuccess,t.data),t}.bind(this))["catch"](function(t){throw this.unsubscribe().emit(this.events.subscribeError,t),t}.bind(this))},o.prototype.renew=function(t){return t=t||{},t.events&&(this.eventFilters=t.events),this.clearTimeout(),new(this.context.getPromise())(function(t){if(!this.subscription||!this.subscription.id)throw new Error("Subscription ID is required");if(!this.eventFilters||!this.eventFilters.length)throw new Error("Events are undefined");t()}.bind(this)).then(function(){return this.getPlatform().apiCall({method:"PUT",url:"/restapi/v1.0/subscription/"+this.subscription.id,post:{eventFilters:this.getFullEventFilters()}})}.bind(this)).then(function(t){return this.updateSubscription(t.data).emit(this.events.renewSuccess,t.data),t}.bind(this))["catch"](function(t){throw this.unsubscribe().emit(this.events.renewError,t),t}.bind(this))},o.prototype.remove=function(t){return t=u.extend({async:!0},t),new(this.context.getPromise())(function(e){if(!this.subscription||!this.subscription.id)throw new Error("Subscription ID is required");e(this.getPlatform().apiCall({async:!!t.async,method:"DELETE",url:"/restapi/v1.0/subscription/"+this.subscription.id}))}.bind(this)).then(function(t){return this.unsubscribe().emit(this.events.removeSuccess,t),t}.bind(this))["catch"](function(t){throw this.emit(this.events.removeError,t),t}.bind(this))},o.prototype.destroy=function(){return this.unsubscribe(),s.info("RC.core.Subscription: Destroyed"),i.prototype.destroy.call(this)},o.prototype.isSubscribed=function(){return this.subscription&&this.subscription.deliveryMode&&this.subscription.deliveryMode.subscriberKey&&this.subscription.deliveryMode.address},o.prototype.setTimeout=function(){var t=1e3*this.subscription.expiresIn-a;this.timeout=setTimeout(function(){this.renew({})}.bind(this),t)},o.prototype.clearTimeout=function(){clearTimeout(this.timeout)},o.prototype.updateSubscription=function(t){return this.clearTimeout(),this.subscription=t,this.setTimeout(),this},o.prototype.unsubscribe=function(){return this.clearTimeout(),this.pubnub&&this.isSubscribed()&&this.pubnub.unsubscribe({channel:this.subscription.deliveryMode.address}),this.subscription=null,this},o.prototype.notify=function(t){if(this.isSubscribed()&&this.subscription.deliveryMode.encryptionKey){var e=this.getCrypto(),n=e.enc.Base64.parse(this.subscription.deliveryMode.encryptionKey),r=e.enc.Base64.parse(t),o=e.AES.decrypt({ciphertext:r},n,{mode:e.mode.ECB,padding:e.pad.Pkcs7}).toString(e.enc.Utf8);t=JSON.parse(o)}return this.emit(this.events.notification,t),this},o.prototype.subscribeAtPubnub=function(){if(!this.isSubscribed())return this;var t=this.getPubnub();return this.pubnub=t.init({ssl:!0,subscribe_key:this.subscription.deliveryMode.subscriberKey}),this.pubnub.ready(),this.pubnub.subscribe({channel:this.subscription.deliveryMode.address,message:function(t){s.info("RC.core.Subscription: Incoming message",t),this.notify(t)}.bind(this),connect:function(){s.info("RC.core.Subscription: PUBNUB connected")}.bind(this)}),this},r.exports={Class:o,$get:function(t){return new o(t)}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(){i.call(this);var t="hidden",e=function(e){e=e||window.event;var n="visible",r="hidden",o={focus:n,focusin:n,pageshow:n,blur:r,focusout:r,pagehide:r};this.visible=e.type in o?o[e.type]==n:!document[t],this.emit(this.events.change,this.visible)}.bind(this);this.visible=!0,"undefined"!=typeof document&&"undefined"!=typeof window&&(t in document?document.addEventListener("visibilitychange",e):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(t="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e)}var i=n(16).Class;o.prototype=Object.create(i.prototype),Object.defineProperty(o.prototype,"constructor",{value:o,enumerable:!1}),o.prototype.events={change:"change"},o.prototype.isVisible=function(){return this.visible},r.exports={Class:o,$get:function(){return new o}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){this.context=t}var i=n(19);o.prototype.defaultProperty="id",o.prototype.getContext=function(){return this.context},o.prototype.createUrl=function(){return""},o.prototype.getId=function(t){return t&&t[this.defaultProperty]},o.prototype.isNew=function(t){return!this.getId(t)||!this.getUri(t)},o.prototype.resetAsNew=function(t){return t&&(delete t.id,delete t.uri),t},o.prototype.getUri=function(t){return t&&t.uri},o.prototype.parseMultipartResponse=function(t){return t.isMultipart()?t.data.filter(function(t){return!t.error}).map(function(t){return t.data}):[t.data]},o.prototype.loadRequest=function(t,e){return i.extend(e||{},{url:e&&e.url||t&&this.getUri(t)||this.createUrl(),method:e&&e.method||"GET"})},o.prototype.saveRequest=function(t,e){if(!(t||e&&(e.post||e.body)))throw new Error("No Object");return i.extend(e||{},{method:e&&e.method||(this.isNew(t)?"POST":"PUT"),url:e&&e.url||this.getUri(t)||this.createUrl(),body:e&&(e.body||e.post)||t})},o.prototype.deleteRequest=function(t,e){if(e=e||{},!(this.getUri(t)||e&&e.url))throw new Error("Object has to be not new or URL must be provided");return i.extend(e||{},{method:e&&e.method||"DELETE",url:e&&e.url||this.getUri(t)})},o.prototype.syncRequest=function(t){return t=t||{},t.url=t.url||this.createUrl({sync:!0}),t.query=t.query||t.get||{},t.query.syncToken?t.query={syncType:"ISync",syncToken:t.get.syncToken}:t.query.syncType="FSync",t},o.prototype.nextPageExists=function(t){return t&&t.navigation&&"nextPage"in t.navigation},o.prototype.index=function(t,e,n){return e=e||this.getId.bind(this),t=t||[],t.reduce(function(t,r){var o=e(r);return!o||t[o]&&!n?t:(n?(t[o]||(t[o]=[]),t[o].push(r)):t[o]=r,t)},{})},o.prototype.merge=function(t,e,n,r){n=n||this.getId.bind(this),t=t||[],e=e||[];var o=this.index(e,n),s=[],u=t.map(function(t){var e=n(t),u=o[e];return u&&s.push(e),u?r?i.extend(t,u):u:t});return e.forEach(function(t){-1==s.indexOf(n(t))&&u.push(t)}),u},r.exports={Class:o,$get:function(t){return new o(t)}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){function o(){if(!(this instanceof o))throw new Error("Observable(): New operator was omitted");Object.defineProperty(this,"listeners",{value:{},enumerable:!1,writable:!0}),Object.defineProperty(this,"oneTimeEvents",{value:{},enumerable:!1,writable:!0}),Object.defineProperty(this,"oneTimeArguments",{value:{},enumerable:!1,writable:!0})}var i=n(19),s=n(18);Object.defineProperty(o.prototype,"constructor",{value:o,enumerable:!1}),o.prototype.hasListeners=function(t){return t in this.listeners},o.prototype.registerOneTimeEvent=function(t){this.oneTimeEvents[t]=!1,this.oneTimeArguments[t]=[]},o.prototype.on=function(t,e){if("string"==typeof t&&(t=[t]),!t)throw new Error("No events to subscribe to");if("function"!=typeof e)throw new Error("Callback must be a function");var n=this;return t.forEach(function(t){n.hasListeners(t)||(n.listeners[t]=[]),n.listeners[t].push(e),n.isOneTimeEventFired(t)&&(s.debug("Observable.on(%s): One-time event has been fired already, executing callback",t),e.apply(n,n.getOneTimeEventArgumens(t)))}),this},o.prototype.emit=function(t){if(this.isOneTimeEventFired(t))return s.debug("Observable.emit(%s): One-time event has been fired already",t),null;var e=this,n=i.argumentsToArray(arguments).splice(1),r=null;return this.isOneTimeEvent(t)&&(this.setOneTimeEventFired(t),this.setOneTimeEventArgumens(t,n)),this.hasListeners(t)?(this.listeners[t].some(function(t){return r=t.apply(e,n),r===!1}),r):null},o.prototype.off=function(t,e){var n=this;if(e){if(!this.hasListeners(t))return this;this.listeners[t].forEach(function(r,o){r===e&&delete n.listeners[t][o]})}else delete this.listeners[t];return this},o.prototype.isOneTimeEvent=function(t){return t in this.oneTimeEvents},o.prototype.isOneTimeEventFired=function(t){return this.isOneTimeEvent(t)?this.oneTimeEvents[t]:!1},o.prototype.setOneTimeEventFired=function(t){this.oneTimeEvents[t]=!0},o.prototype.setOneTimeEventArgumens=function(t,e){this.oneTimeArguments[t]=e},o.prototype.getOneTimeEventArgumens=function(t){return this.oneTimeArguments[t]},o.prototype.offAll=function(){this.listeners={},this.oneTimeEvents={},this.oneTimeArguments={}},o.prototype.destroy=function(){return this.offAll(),s.debug("Observable.destroy(): Listeners were destroyed"),this},o.prototype.emitAndCallback=function(t,e,n){return e=i.argumentsToArray(e),t&&this.emit.apply(this,[t].concat(e)),n&&n.apply(this,e),this},r.exports={Class:o,$get:function(t){return new o(t)}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";var o=n(19),i=r.exports={validate:function(t){var e={errors:{},isValid:!0};return e.errors=t.reduce(function(t,n){var r=n.validator();return r.length>0&&(e.isValid=!1,t[n.field]=t[n.field]||[],t[n.field]=t[n.field].concat(r)),t},{}),e},email:function(t,e){return function(){return t?o.isEmail(t,e)?[]:[new Error("Value has to be a valid email")]:[]}},phone:function(t){return function(){return t?o.isPhoneNumber(t)?[]:[new Error("Value has to be a valid US phone number")]:[]}},required:function(t){return function(){return t?[]:[new Error("Field is required")]}},length:function(t,e,n){return function(){var r=[];return t?(t=t.toString(),n&&t.length<n&&r.push(new Error("Minimum length of "+n+" characters is required")),e&&t.length>e&&r.push(new Error("Maximum length of "+e+" characters is required")),r):r}},$get:function(){return i}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";var o=n(19),i=r.exports={logDebug:!1,logInfo:!1,logWarnings:!1,logErrors:!1,addTimestamps:!0,console:console||{log:function(){},warn:function(){},info:function(){},error:function(){}},disableAll:function(){this.logDebug=!1,this.logInfo=!1,this.logWarnings=!1,this.logErrors=!1},enableAll:function(){this.logDebug=!0,this.logInfo=!0,this.logWarnings=!0,this.logErrors=!0},parseArguments:function(t){return t=o.argumentsToArray(t),this.addTimestamps&&t.unshift((new Date).toLocaleString(),"-"),t},debug:function(){this.logDebug&&this.console.log.apply(this.console,this.parseArguments(arguments))},info:function(){this.logInfo&&this.console.info.apply(this.console,this.parseArguments(arguments))},warn:function(){this.logWarnings&&this.console.warn.apply(this.console,this.parseArguments(arguments))},error:function(){this.logErrors&&this.console.error.apply(this.console,this.parseArguments(arguments))},$get:function(){return i}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))
},function(t,e,n){var r;r=function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=/\d/,s={};"Boolean Number String Function Array Date RegExp Object".split(" ").forEach(function(t){s["[object "+t+"]"]=t.toLowerCase()});var u=n.exports={extend:function(){var t,e,n,r,o,i,s=arguments[0]||{},u=1,a=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[u]||{},u++),"object"==typeof s||this.isFunction(s)||(s={});a>u;u++)if(null!==(t=arguments[u]))for(e in t)n=s[e],r=t[e],s!==r&&(c&&r&&(this.isPlainObject(r)||(o=this.isArray(r)))?(o?(o=!1,i=n&&this.isArray(n)?n:[]):i=n&&this.isPlainObject(n)?n:{},s[e]=this.extend(c,i,r)):void 0!==r&&(s[e]=r));return s},forEach:function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var r=e(t[n],n);if(r===!1)break}},queryStringify:function(t){var e=[],n=this;return this.forEach(t,function(t,r){n.isArray(t)?t.forEach(function(t){e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}),e.join("&")},parseQueryString:function(t){var e={},n=this;return t.split("&").forEach(function(t){if(t=decodeURIComponent(t),-1==t.indexOf("="))e[t.trim()]=!0;else{var r=t.split("="),o=r[0].trim(),i=r[1].trim();o in e?(o in e&&!n.isArray(e[o])&&(e[o]=[e[o]]),e[o].push(i)):e[o]=i}}),e},isEmail:function(t,e){return e?/^(?:[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?[ ,;]*)+$/i.test(t):/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i.test(t)},isPhoneNumber:function(t){return/\+?1[0-9]{3}[0-9a-z]{7}/im.test(t.toString().split(/[^0-9a-z\+]/im).join(""))},argumentsToArray:function(t){return Array.prototype.slice.call(t||[],0)},isDate:function(t){return"date"===this.type(t)},isFunction:function(t){return"function"===this.type(t)},isArray:Array.isArray||function(t){return"array"===this.type(t)},isWindow:function(t){return t&&"object"==typeof t&&"setInterval"in t},isNaN:function(t){return null===t||!i.test(t)||isNaN(t)},type:function(t){return null===t?String(t):s[o.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==this.type(t)||t.nodeType||this.isWindow(t))return!1;if(t.constructor&&!r.call(t,"constructor")&&!r.call(t.constructor.prototype,"isPrototypeOf"))return!1;var e;for(e in t);return void 0===e||r.call(t,e)},getProperty:function(t,e){return e.split(/[.[\]]/).reduce(function(t,e){return t?e?t[e]:t:void 0},t)},poll:function(t,e,n){this.stopPolling(n),e=e||1e3;var r=function(n){return n=n||e,e=n,setTimeout(function(){t(r,n)},n)};return r()},stopPolling:function(t){t&&clearTimeout(t)},parseString:function(t){return t?t.toString():""},parseNumber:function(t){return t?(t=parseFloat(t),isNaN(t)?0:t):0},$get:function(){return u}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";var o=n(19),i=r.exports={propertyExtractor:function(t){return function(e){return t?e&&e[t]||null:e}},stringComparator:function(t,e){return o.parseString(t).localeCompare(o.parseString(e))},numberComparator:function(t,e){return o.parseNumber(t)-o.parseNumber(e)},comparator:function(t){function e(e,n){return t.compareFn(t.extractFn(e,t),t.extractFn(n,t),t)}return t=o.extend({extractFn:this.propertyExtractor(t&&t.sortBy||null),compareFn:this.stringComparator},t),e},equalsFilter:function(t,e){return e.condition===t},containsFilter:function(t,e){return t&&t.toString().indexOf(e.condition)>-1},regexpFilter:function(t,e){if(!(e.condition instanceof RegExp))throw new Error("Condition must be an instance of RegExp");return e.condition.test(t)},filter:function(t){function e(e){return t.reduce(function(t,n){return t&&n.condition?n.filterFn(n.extractFn(e,n),n):t},!0)}var n=this;return t=(t||[]).map(function(t){return o.extend({condition:"",extractFn:n.propertyExtractor(t&&t.filterBy||null),filterFn:n.equalsFilter},t)}),e},$get:function(){return i}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class;o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(){return"/dictionary/country"},r.exports={Class:o,$get:function(t){return t.createSingleton("CountryHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class;o.prototype=Object.create(i.prototype),o.prototype.getId=function(t){return t?t.id+(t.addons&&t.addons[0]?"-"+t.addons[0].id+"-"+t.addons[0].count:""):null},o.prototype.cleanForSaving=function(t){return t?(delete t.name,delete t.deviceClass,t.addons&&t.addons.length>0?t.addons.forEach(function(e,n){delete t.addons[n].name}):delete t.addons,t):null},o.prototype.devices=[{id:"-1",name:"Softphone"},{id:"0",name:"Existing device"},{id:"19",name:"Cisco SPA-525G2 Desk Phone",deviceClass:"Desk Phone"},{id:"23",name:"Polycom IP 321 Basic IP phone",deviceClass:"Desk Phone"},{id:"30",name:"Polycom IP 550 HD Manager IP phone",deviceClass:"Desk Phone"},{id:"37",name:"Polycom IP 6000 Conference Phone",deviceClass:"Conference Phone"},{id:"40",name:"Polycom IP 335 HD IP phone",deviceClass:"Desk Phone"},{id:"51",name:"Cisco SPA-303 Desk Phone",deviceClass:"Desk Phone"},{id:"16",name:"Cisco SPA-508G Desk Phone with 1 Expansion Module",deviceClass:"Desk Phone",addons:[{id:"2",name:"Cisco Sidecar",count:"1"}]},{id:"16",name:"Cisco SPA-508G Desk Phone with 2 Expansion Modules",deviceClass:"Desk Phone",addons:[{id:"2",name:"Cisco Sidecar",count:"2"}]},{id:"16",name:"Cisco SPA-508G Desk Phone",deviceClass:"Desk Phone"},{id:"19",name:"Cisco SPA-525G2 Desk Phone with 1 Expansion Module",deviceClass:"Desk Phone",addons:[{id:"2",name:"Cisco Sidecar",count:"1"}]},{id:"19",name:"Cisco SPA-525G2 Desk Phone with 2 Expansion Modules	Desk Phone",addons:[{id:"2",name:"Cisco Sidecar",count:"2"}]},{id:"34",name:"Polycom IP 650 HD Executive IP phone with 1 Expansion Module",deviceClass:"Desk Phone",addons:[{id:"1",name:"Plolycom Expansion",count:"1"}]},{id:"34",name:"Polycom IP 650 HD Executive IP phone with 2 Expansion Modules",deviceClass:"Desk Phone",addons:[{id:"1",name:"Plolycom Expansion",count:"2"}]},{id:"34",name:"Polycom IP 650 HD Executive IP phone with 3 Expansion Modules",deviceClass:"Desk Phone",addons:[{id:"1",name:"Plolycom Expansion",count:"3"}]},{id:"34",name:"Polycom IP 650 HD Executive IP phone",deviceClass:"Desk Phone"},{id:"52",name:"Cisco SPA-122 ATA",deviceClass:"Analog Adapter"},{id:"53",name:"Polycom VVX-500 Color Touchscreen",deviceClass:"Desk Phone"},{id:"54",name:"Polycom VVX-310 Gigabit Ethernet Phone",deviceClass:"Desk Phone"},{id:"55",name:"Polycom VVX-410 Color Gigabit Ethernet Phone",deviceClass:"Desk Phone"}],r.exports={Class:o,$get:function(t){return t.createSingleton("DeviceModelHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class;o.prototype=Object.create(i.prototype),o.prototype.languages=[{id:"1033",name:"English (US)"},{id:"3084",name:"French (Canada)"}],r.exports={Class:o,$get:function(t){return t.createSingleton("LanguageHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t),this.state=n(26).$get(t)}var i=n(15).Class,s=n(20),u=n(19);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(){return"/dictionary/location"},o.prototype.filter=function(t){var e=[];return t=u.extend({stateId:"",onlyUniqueNPA:!1},t),s.filter([{condition:t.stateId,filterFn:function(t,e){return this.state.getId(t.state)==e.condition}.bind(this)},{condition:t.onlyUniqueNPA,filterFn:function(t){return-1==e.indexOf(t.npa)?(e.push(t.npa),!0):!1}}])},o.prototype.comparator=function(t){return t=u.extend({sortBy:"npa"},t),"nxx"==t.sortBy&&(t.extractFn=function(t){return 1e6*parseInt(t.npa)+parseInt(t.nxx)},t.compareFn=s.numberComparator),s.comparator(t)},r.exports={Class:o,$get:function(t){return t.createSingleton("LocationHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class;o.prototype=Object.create(i.prototype),o.prototype.shippingMethods=[{id:"1",name:"Ground Shipping (5-7 business days)"},{id:"2",name:"2-days Shipping"},{id:"3",name:"Overnight Shipping"}],r.exports={Class:o,$get:function(t){return t.createSingleton("ShippingMethodHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t),this.countryHelper=n(21).$get(t)}var i=n(15).Class,s=n(20),u=n(19);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(){return"/dictionary/state"},o.prototype.filter=function(t){return t=u.extend({countryId:""},t),s.filter([{condition:t.countryId,filterFn:function(t,e){return this.countryHelper.getId(t.country)==e.condition}.bind(this)}])},r.exports={Class:o,$get:function(t){return t.createSingleton("StateHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class;o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(){return"/dictionary/timezone"},r.exports={Class:o,$get:function(t){return t.createSingleton("TimezoneHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class;o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(){return"/account/~"},r.exports={Class:o,$get:function(t){return t.createSingleton("AccountHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class,s=n(17);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId?t.extensionId:"~")+"/blocked-number"+(e?"/"+e:"")},o.prototype.validate=function(t){return s.validate([{field:"phoneNumber",validator:s.phone(t.phoneNumber)},{field:"phoneNumber",validator:s.required(t.phoneNumber)},{field:"name",validator:s.required(t.name)}])},r.exports={Class:o,$get:function(t){return t.createSingleton("BlockedNumberHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t),this.presence=n(39).$get(t),this.contact=n(32).$get(t)}var i=n(15).Class,s=n(19),u=n(20);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(t,e){return t=t||{},"personal"in t||"extensionId"in t||(t.personal=!0),"/account/~/"+(t.personal||t.extensionId?"extension/"+(t.extensionId||"~")+"/":"")+(t.active?"active-calls":"call-log")+(e?"/"+e:"")},o.prototype.getSessionId=function(t){return t&&t.sessionId},o.prototype.isInProgress=function(t){return t&&"In Progress"==t.result},o.prototype.isAlive=function(t){return t&&"Alive"==t.availability},o.prototype.isInbound=function(t){return t&&"Inbound"==t.direction},o.prototype.isOutbound=function(t){return!this.isInbound(t)},o.prototype.isMissed=function(t){return t&&"Missed"==t.result},o.prototype.isFindMe=function(t){return t&&"FindMe"==t.action},o.prototype.getCallerInfo=function(t){return this.isInbound(t)?t.from:t.to},o.prototype.getAllCallerInfos=function(t){return[this.getCallerInfo(t)].concat(this.isInbound(t)?t.to:t.from)},o.prototype.formatDuration=function(t){function e(t){return 10>t?"0"+t:t}var n=parseInt(t.duration),r=Math.floor(n/3600),o=Math.floor(n%3600/60),i=Math.floor(n%60);return(r?r+":":"")+e(o)+":"+e(i)},o.prototype.filter=function(t){return t=s.extend({alive:!0,direction:"",type:""},t),u.filter([{filterBy:"direction",condition:t.direction},{filterBy:"type",condition:t.type}])},o.prototype.comparator=function(t){return u.comparator(s.extend({sortBy:"startTime"},t))},o.prototype.attachContacts=function(t,e,n){var r=this,o=e.reduce(function(t,e){return t.concat(r.getAllCallerInfos(e))},[]);this.contact.attachToCallerInfos(o,t,n)},o.prototype.checkMergeability=function(t,e,n){function r(t){return new Date(t).getTime()}return(!n.strict||t.action&&-1!=t.action.toLowerCase().indexOf("ringout"))&&"Outbound"==t.direction&&"Inbound"==e.direction&&(!e.startTime&&!t.startTime||Math.abs(r(e.startTime)-r(t.startTime))<(n.maxStartTimeDiscrepancy||5e3))&&e.from.phoneNumber==t.to.phoneNumber&&(e.to.phoneNumber==t.from.phoneNumber||e.to.name==t.from.name)},o.prototype.combineCalls=function(t,e,n){n=n||{};var r=[];return t.hasSubsequent=!0,n.merge?(t.duration=t.duration>e.duration?t.duration:e.duration,t.from=e.to,t.to=e.from,r.push(t)):(e.subsequent=!0,e.startTime=t.startTime,r.push(t),r.push(e)),r},o.prototype.processCalls=function(t,e){var n=[],r=[],o=this;return t.forEach(function(i){var s=!1;i.subsequent=!1,i.hasSubsequent=!1,t.some(function(t){return i===t?!1:(o.checkMergeability(i,t,e)&&(n=n.concat(o.combineCalls(i,t,e)),r.push(i),r.push(t),s=!0),s)})}),t.forEach(function(t){-1==r.indexOf(t)&&n.push(t)}),n},o.prototype.parsePresenceCalls=function(t){return t.map(function(t){return{id:t.id,uri:"",sessionId:t.sessionId,from:{phoneNumber:t.from},to:{phoneNumber:t.to},direction:t.direction,startTime:"",duration:0,type:"",action:"",result:this.presence.isCallInProgress(t)?"In Progress":t.telephonyStatus,telephonyStatus:t.telephonyStatus}},this)},o.prototype.getSignature=function(t){function e(t){return(t||"").toString().replace(/[^0-9]/gi,"")}return t.direction+"|"+(t.from&&e(t.from.phoneNumber))+"|"+(t.to&&e(t.to.phoneNumber))},o.prototype.mergePresenceCalls=function(t,e){var n=new Date,r=this.parsePresenceCalls(e&&e.activeCalls||[]).map(function(t){return delete t.startTime,t});return t=this.merge(t||[],r,this.getSessionId,!0),t.forEach(function(t){t.startTime||(t.startTime=n.toISOString())}),t},o.prototype.mergeAll=function(t,e,n){var r=this.merge(t||[],e||[],this.getSessionId,!0);return this.merge(r,n||[],this.getSessionId,!0)},r.exports={Class:o,$get:function(t){return t.createSingleton("CallHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class;o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(){return"/account/~/extension/~/conferencing"},r.exports={Class:o,$get:function(t){return t.createSingleton("ConferencingHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){u.call(this,t)}var i=n(19),s=n(17),u=n(15).Class,a=n(20);o.prototype=Object.create(u.prototype),o.prototype.createUrl=function(t,e){t=t||{};var n="/account/~/extension/"+(t.extensionId?t.extensionId:"~")+"/address-book";return t.sync?n+"-sync":n+(t.groupId?"/group/"+t.groupId+"/contact":"/contact")+(e?"/"+e:"")},o.prototype.getFieldValues=function(t,e,n){return e.reduce(function(e,r){return t&&t[r]&&(n?e[r]=t[r]:e.push(t[r])),e},n?{}:[])},o.prototype.getFullName=function(t){return this.getFieldValues(t,this.nameFields).join(" ")},o.prototype.getEmails=function(t,e){return this.getFieldValues(t,this.emailFields,e)},o.prototype.getPhones=function(t,e){return this.getFieldValues(t,this.phoneFields,e)},o.prototype.getFaxes=function(t,e){return this.getFieldValues(t,this.faxFields,e)},o.prototype.getAddresses=function(t,e){return this.getFieldValues(t,this.addressFields,e)},o.prototype.isAlive=function(t){return"Alive"==t.availability},o.prototype.match=function(t,e,n){function r(t){if(!o){var r=n.transformFn(t,n);if(r){var i=n.strict?r==e:r.indexOf(e)>-1;i&&(o=t)}}}n=i.extend({fields:[].concat(this.nameFields,this.emailFields,this.phoneFields,this.faxFields,this.otherFields),inAddresses:!0,transformFn:function(t){return t?t.toString().toLocaleLowerCase():""},strict:!1},n),e=n.transformFn(e,n);var o=null;return e?(n.fields.forEach(function(e){r(t[e])}),n.inAddresses&&!o&&this.addressFields.forEach(function(e){t[e]&&!o&&this.addressSubFields.forEach(function(n){r(t[e][n])})},this),o):o},o.prototype.matchAsPhone=function(t,e,n){return this.match(t,e,i.extend({fields:[].concat(this.phoneFields,this.faxFields),inAddresses:!1,transformFn:function(t){return t?t.toString().replace(/[^\d\w]/gi,""):""},strict:!1},n))},o.prototype.attachToCallerInfos=function(t,e,n){var r=this,o=this.index(t,function(t){return t.phoneNumber},!0);i.forEach(o,function(t,o){var i=null,s=null;e.some(function(t){return s=r.matchAsPhone(t,o,n),s&&(i=t),s}),i&&t.forEach(function(t){t.contact=i,t.contactPhone=s})})},o.prototype.comparator=function(t){var e=this;return a.comparator(i.extend({extractFn:function(t){return e.getFullName(t)}},t))},o.prototype.filter=function(t){var e=this;return t=i.extend({alive:!0,startsWith:"",phonesOnly:!1,faxesOnly:!1},t),a.filter([{condition:t.alive,filterFn:this.isAlive},{condition:t.startsWith,filterFn:function(t,n){return e.match(t,n.condition)}},{condition:t.phonesOnly,filterFn:function(t){return e.getPhones(t).length>0}},{condition:t.faxesOnly,filterFn:function(t){return e.getFaxes(t).length>0}}])},o.prototype.validate=function(t){return s.validate([{field:"firstName",validator:s.required(t.firstName)},{field:"lastName",validator:s.required(t.lastName)},{field:"email",validator:s.email(t.email)},{field:"email2",validator:s.email(t.email2)},{field:"email3",validator:s.email(t.email3)}])},o.prototype.phoneFields=["homePhone","homePhone2","businessPhone","businessPhone2","mobilePhone","companyPhone","assistantPhone","carPhone","otherPhone","callbackPhone"],o.prototype.faxFields=["businessFax","otherFax"],o.prototype.addressFields=["homeAddress","businessAddress","otherAddress"],o.prototype.addressSubFields=["street","city","state","zip"],o.prototype.nameFields=["firstName","middleName","lastName","nickName"],o.prototype.otherFields=["company","jobTitle","webPage","notes"],o.prototype.emailFields=["email","email2","email3"],r.exports={Class:o,$get:function(t){return t.createSingleton("ContactHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class,s=n(17);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(t,e){return"/account/~/extension/~/address-book/group"+(e?"/"+e:"")},o.prototype.validate=function(t){return s.validate([{field:"groupName",validator:s.required(t&&t.groupName)}])},r.exports={Class:o,$get:function(t){return t.createSingleton("ContactGroupHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t),this.extension=n(35).$get(t),this.deviceModel=n(22).$get(t)}var i=n(15).Class,s=n(17);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(t,e){return t=t||{},t.order?"/account/~/order":"/account/~"+(t.extensionId?"/extension/"+t.extensionId:"")+"/device"+(e?"/"+e:"")},o.prototype.validate=function(t){return s.validate([{field:"emergencyServiceAddress-street",validator:s.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.street)},{field:"emergencyServiceAddress-city",validator:s.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.city)},{field:"emergencyServiceAddress-state",validator:s.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.state)},{field:"emergencyServiceAddress-country",validator:s.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.country)},{field:"emergencyServiceAddress-zip",validator:s.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.zip)},{field:"emergencyServiceAddress-customerName",validator:s.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.customerName)},{field:"extension",validator:s.required(this.extension.getId(t&&t.extension))},{field:"model",validator:s.required(this.deviceModel.getId(t&&t.model))}])},r.exports={Class:o,$get:function(t){return t.createSingleton("DeviceHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class,s=n(20),u=n(19);o.prototype=Object.create(i.prototype),o.prototype.type={department:"Department",user:"User",announcement:"Announcement",voicemail:"Voicemail"},o.prototype.createUrl=function(t,e){return t=t||{},"/account/~"+(t.departmentId?"/department/"+t.departmentId+"/members":"/extension")+(e?"/"+e:"")},o.prototype.isUser=function(t){return t&&t.type==this.type.user},o.prototype.isDepartment=function(t){return t&&t.type==this.type.department},o.prototype.isAnnouncement=function(t){return t&&t.type==this.type.announcement},o.prototype.isVoicemail=function(t){return t&&t.type==this.type.voicemail},o.prototype.comparator=function(t){return s.comparator(u.extend({sortBy:"extensionNumber",compareFn:s.numberComparator},t))},o.prototype.filter=function(t){return t=u.extend({search:"",type:""},t),s.filter([{filterBy:"type",condition:t.type},{condition:t.search.toLocaleLowerCase(),filterFn:s.containsFilter,extractFn:function(t){return(t.name&&t.name.toLocaleLowerCase()+" ")+(t.extensionNumber&&t.extensionNumber.toString().toLocaleLowerCase())}}])},r.exports={Class:o,$get:function(t){return t.createSingleton("ExtensionHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t)}var i=n(15).Class,s=n(19),u=n(20);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId||"~")+"/forwarding-number"+(e?"/"+e:"")},o.prototype.getId=function(t){return t.id||t.phoneNumber},o.prototype.hasFeature=function(t,e){return!!t.features&&-1!=t.features.indexOf(e)},o.prototype.comparator=function(t){return u.comparator(s.extend({sortBy:"label"},t))},o.prototype.filter=function(t){var e=this;return t=s.extend({features:[]},t),u.filter([{condition:t.features.length,filterFn:function(n){return t.features.some(function(t){return e.hasFeature(n,t)})}}])},r.exports={Class:o,$get:function(t){return t.createSingleton("ForwardingNumberHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t),this.platform=n(11).$get(t),this.contact=n(32).$get(t)}var i=n(15).Class,s=n(17),u=n(19),a=n(20);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(t,e){t=t||{};var n="/account/~/extension/"+(t.extensionId||"~");return t.fax?n+"/fax":t.sms?n+"/sms":t.pager?n+"/company-pager":t.sync?n+"/message-sync":n+"/message-store"+(e?"/"+e:"")},o.prototype.isInbound=function(t){return t&&"Inbound"==t.direction},o.prototype.isOutbound=function(t){return!this.isInbound(t)},o.prototype.isSMS=function(t){return t&&"SMS"==t.type},o.prototype.isPager=function(t){return t&&"Pager"==t.type},o.prototype.isVoiceMail=function(t){return t&&"VoiceMail"==t.type},o.prototype.isFax=function(t){return t&&"Fax"==t.type},o.prototype.isAlive=function(t){return t&&"Alive"==t.availability},o.prototype.isRead=function(t){return"Read"==t.readStatus},o.prototype.setIsRead=function(t,e){return t.readStatus=e?"Read":"Unread",t},o.prototype.getAttachmentUrl=function(t,e){return t.attachments[e]?this.platform.apiUrl(t.attachments[e].uri,{addMethod:"GET",addServer:!0,addToken:!0}):""},o.prototype.getAttachmentContentType=function(t,e){return t.attachments[e]?t.attachments[e].contentType:""},o.prototype.getSubscription=function(t){return n(13).$get(this.context).setEvents([this.createUrl(t)])},o.prototype.getCallerInfos=function(t){return this.isInbound(t)?[t.from]:t.to},o.prototype.getAllCallerInfos=function(t){return this.getCallerInfos(t).concat(this.isInbound(t)?t.to:[t.from])},o.prototype.comparator=function(t){return a.comparator(u.extend({sortBy:"creationTime"},t))},o.prototype.filter=function(t){return t=u.extend({search:"",alive:!0,direction:"",conversationId:"",readStatus:""},t),a.filter([{condition:t.alive,filterFn:this.isAlive},{filterBy:"type",condition:t.type},{filterBy:"direction",condition:t.direction},{filterBy:"conversationId",condition:t.conversationId},{filterBy:"readStatus",condition:t.readStatus},{filterBy:"subject",condition:t.search,filterFn:a.containsFilter}])},o.prototype.attachContacts=function(t,e,n){var r=this,o=e.reduce(function(t,e){return t.concat(r.getAllCallerInfos(e))},[]);this.contact.attachToCallerInfos(o,t,n)},o.prototype.shorten=function(t){return{from:t.from,to:t.to,text:t.subject}},o.prototype.validateSMS=function(t){return s.validate([{field:"to",validator:s.required(u.getProperty(t,"to[0].phoneNumber"))},{field:"from",validator:s.required(u.getProperty(t,"from.phoneNumber"))},{field:"subject",validator:s.required(u.getProperty(t,"subject"))},{field:"subject",validator:s.length(u.getProperty(t,"subject"),160)}])},o.prototype.validatePager=function(t){return s.validate([{field:"to",validator:s.required(u.getProperty(t,"to.extensionNumber"))},{field:"from",validator:s.required(u.getProperty(t,"from.extensionNumber"))},{field:"subject",validator:s.required(u.getProperty(t,"subject"))},{field:"subject",validator:s.length(u.getProperty(t,"subject"),160)}])},r.exports={Class:o,$get:function(t){return t.createSingleton("MessageHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){u.call(this,t),this.extension=n(35).$get(t)}var i=n(20),s=n(19),u=n(15).Class;o.prototype=Object.create(u.prototype),o.prototype.createUrl=function(t,e){return t=t||{},t.lookup?"/number-pool/lookup":"/account/~"+(t.extensionId?"/extension/"+t.extensionId:"")+"/phone-number"+(e?"/"+e:"")},o.prototype.isSMS=function(t){return this.hasFeature(t,"SmsSender")},o.prototype.hasFeature=function(t,e){return!!t.features&&-1!=t.features.indexOf(e)},o.prototype.reserve=function(t,e){t.reservedTill=new Date(e).toISOString()},o.prototype.unreserve=function(t){t.reservedTill=null},o.prototype.comparator=function(t){return i.comparator(s.extend({extractFn:function(t){return t.usageType+"-"+t.paymentType+"-"+t.type}},t))},o.prototype.filter=function(t){var e=this;return t=s.extend({usageType:"",paymentType:"",type:"",features:[]},t),i.filter([{filterBy:"usageType",condition:t.usageType},{filterBy:"paymentType",condition:t.paymentType},{filterBy:"type",condition:t.type},{condition:t.features.length,filterFn:function(n){return t.features.some(function(t){return e.hasFeature(n,t)})}}])},r.exports={Class:o,$get:function(t){return t.createSingleton("PhoneNumberHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t),this.extension=n(35).$get(t)}var i=n(15).Class,s=n(19);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(e||"~")+"/presence"+(t.detailed?"?detailedTelephonyState=true":"")},o.prototype.getId=function(t){return t&&(this.extension.getId(t.extension)||t.extensionId)},o.prototype.isAvailable=function(t){return t&&"Available"==t.presenceStatus},o.prototype.getSubscription=function(t,e){return n(13).$get(this.context).setEvents([this.createUrl(t,e)])},o.prototype.updateSubscription=function(t,e,n){var r=e.map(this.getId,this).map(function(t){return this.createUrl(n,t)},this);return t.addEvents(r),t},o.prototype.attachToExtensions=function(t,e,n){var r=this.index(e);t.forEach(function(t){var e=r[this.extension.getId(t)];e&&("presence"in t&&n?s.extend(t.presence,e):t.presence=e)},this)},o.prototype.isCallInProgress=function(t){return t&&"NoCall"!=t.telephonyStatus},r.exports={Class:o,$get:function(t){return t.createSingleton("PresenceHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){i.call(this,t),this.extension=n(35).$get(t)}var i=n(15).Class,s=n(17);o.prototype=Object.create(i.prototype),o.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId||"~")+"/ringout"+(e?"/"+e:"")},o.prototype.resetAsNew=function(t){return t=i.prototype.resetAsNew.call(this,t),t&&delete t.status,t},o.prototype.isInProgress=function(t){return t&&!this.isNew(t)&&t.status&&"InProgress"==t.status.callStatus},o.prototype.isSuccess=function(t){return t&&!this.isNew(t)&&t.status&&"Success"==t.status.callStatus},o.prototype.isError=function(t){return!this.isNew(t)&&!this.isInProgress(t)&&!this.isSuccess(t)},o.prototype.validate=function(t){return s.validate([{field:"to",validator:s.required(t&&t.to&&t.to.phoneNumber)},{field:"from",validator:s.required(t&&t.from&&t.from.phoneNumber)}])},r.exports={Class:o,$get:function(t){return t.createSingleton("RingoutHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){s.call(this,t)}function i(t){return function(e){return this.isEnabled(t,e)}}var s=n(15).Class;o.prototype=Object.create(s.prototype),o.prototype.createUrl=function(){return"/account/~/service-info"},o.prototype.isEnabled=function(t,e){return e.reduce(function(e,n){return n.featureName==t&&(e=n.enabled),e},!1)},o.prototype.isSmsEnabled=i("SMS"),o.prototype.isSmsReceivingEnabled=i("SMSReceiving"),o.prototype.isPresenceEnabled=i("Presence"),o.prototype.isRingOutEnabled=i("RingOut"),o.prototype.isInternationalCallingEnabled=i("InternationalCalling"),o.prototype.isDndEnabled=i("DND"),o.prototype.isFaxEnabled=i("Fax"),o.prototype.isFaxReceivingEnabled=i("FaxReceiving"),o.prototype.isVoicemailEnabled=i("Voicemail"),o.prototype.isPagerEnabled=i("Pager"),o.prototype.isPagerReceivingEnabled=i("PagerReceiving"),o.prototype.isVoipCallingEnabled=i("VoipCalling"),o.prototype.isVideoConferencingEnabled=i("VideoConferencing"),o.prototype.isSalesForceEnabled=i("SalesForce"),o.prototype.isIntercomEnabled=i("Intercom"),o.prototype.isPagingEnabled=i("Paging"),o.prototype.isConferencingEnabled=i("Conferencing"),o.prototype.isFreeSoftPhoneLinesEnabled=i("FreeSoftPhoneLines"),o.prototype.isHipaaComplianceEnabled=i("HipaaCompliance"),o.prototype.isCallParkEnabled=i("CallPark"),o.prototype.isOnDemandCallRecordingEnabled=i("OnDemandCallRecording"),r.exports={Class:o,$get:function(t){return t.createSingleton("serviceHelper",function(){return new o(t)})}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,n){"use strict";function r(){}r.prototype.ready=function(){},r.prototype.unsubscribe=function(){},r.prototype.subscribe=function(t){this.onMessage=t.message},r.prototype.receiveMessage=function(t){this.onMessage(t,"env","channel")},n.exports={$get:function(){return{init:function(t){return new r(t)}}}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(t){this.responses=n(10).$get(t),this.async=!0,this.method="",this.url="",this.requestHeaders={},this.withCredentials=!1,this.data=null,this.readyState=0,this.responseHeaders={},this.status=0,this.context=t}var i=n(18),s=n(19);o.prototype.getResponseHeader=function(t){return this.responseHeaders[t.toLowerCase()]},o.prototype.setRequestHeader=function(t,e){this.requestHeaders[t.toLowerCase()]=e},o.prototype.getAllResponseHeaders=function(){var t=[];return s.forEach(this.responseHeaders,function(e,n){t.push(n+":"+e)}),t.join("\n")},o.prototype.open=function(t,e,n){this.method=t,this.url=e,this.async=n},o.prototype.send=function(t){var e=this.getRequestHeader("Content-Type");
this.data=t,this.data&&"string"==typeof this.data&&("application/json"==e&&(this.data=JSON.parse(this.data)),"application/x-www-form-urlencoded"==e&&(this.data=s.parseQueryString(this.data))),i.debug("API REQUEST",this.method,this.url);var n=this.responses.find(this);if(!n)return void setTimeout(function(){this.onerror&&this.onerror(new Error("Unknown request: "+this.url))}.bind(this),1);this.setStatus(200),this.setResponseHeader("Content-Type","application/json");var r=n.response(this),o=this.context.getPromise(),u=function(t){"application/json"==this.getResponseHeader("Content-Type")&&(t=JSON.stringify(t)),this.responseText=t,setTimeout(function(){this.onload&&this.onload()}.bind(this),1)}.bind(this);r instanceof o?r.then(u.bind(this))["catch"](this.onerror.bind(this)):u(r)},o.prototype.abort=function(){i.debug("XhrMock.destroy(): Aborted")},o.prototype.getRequestHeader=function(t){return this.requestHeaders[t.toLowerCase()]},o.prototype.setResponseHeader=function(t,e){this.responseHeaders[t.toLowerCase()]=e},o.prototype.setStatus=function(t){return this.status=t,this},r.exports={Class:o,$get:function(t){return new o(t)}}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,n){var r;r=function(t,e,r){"use strict";function o(){this.headers={}}var i=n(19);Object.defineProperty(o.prototype,"constructor",{value:o,enumerable:!1}),o.contentType="Content-Type",o.jsonContentType="application/json",o.multipartContentType="multipart/mixed",o.urlencodedContentType="application/x-www-form-urlencoded",o.prototype.setHeader=function(t,e){return this.headers[t.toLowerCase()]=e,this},o.prototype.getHeader=function(t){return this.headers[t.toLowerCase()]},o.prototype.hasHeader=function(t){return t.toLowerCase()in this.headers},o.prototype.setHeaders=function(t){return i.forEach(t,function(t,e){this.setHeader(e,t)}.bind(this)),this},o.prototype.isContentType=function(t){return this.getContentType().indexOf(t)>-1},o.prototype.getContentType=function(){return this.getHeader(o.contentType)||""},o.prototype.isMultipart=function(){return this.isContentType(o.multipartContentType)},o.prototype.isUrlEncoded=function(){return this.isContentType(o.urlencodedContentType)},o.prototype.isJson=function(){return this.isContentType(o.jsonContentType)},r.exports={Class:o}}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))}])});
//# sourceMappingURL=rc-sdk.min.js.map